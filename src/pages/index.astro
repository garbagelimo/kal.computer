---
import BaseLayout from '../layouts/BaseLayout.astro';
import EntryCard from '../components/EntryCard.astro';
import { getCollection } from 'astro:content';

const allProjects = await getCollection('projects');
const projects = allProjects
  .sort((a, b) => b.data.year - a.data.year)
  .slice(0, 4);

const allLinks = await getCollection('links');
const links = allLinks
  .sort((a, b) => {
    const scoreA = (a.data.highlight ? 1 : 0) + (a.data.pubDate ? 1 : 0);
    const scoreB = (b.data.highlight ? 1 : 0) + (b.data.pubDate ? 1 : 0);
    return scoreB - scoreA;
  })
  .slice(0, 4);

const resumeTiles = [
  {
    title: 'Design systems + brand',
    eyebrow: 'design',
    summary: 'Adobe CC (PS, AI, ID), Figma, typography, layout, visual direction.',
  },
  {
    title: 'Web + product build',
    eyebrow: 'web',
    summary: 'Astro, React, HTML/CSS, UI engineering, performance-first builds.',
  },
  {
    title: 'Marketing + growth',
    eyebrow: 'marketing',
    summary: 'Google Ads, SEO strategy, launch plans, positioning + messaging.',
  },
  {
    title: 'Research + insights',
    eyebrow: 'strategy',
    summary: 'Competitive scans, user interviews, concept testing, roadmap shaping.',
  },
  {
    title: 'Content + copy',
    eyebrow: 'writing',
    summary: 'Brand voice, web copy, product narratives, editorial workflows.',
  },
];
---

<BaseLayout title="Home" description="Kal's portfolio, blog, and link board.">
  <section class="panel panel--accent hero">
    <h1>computer motivation webzone</h1>
    <p>
      using the internet so you don’t have to.
    </p>
    <div class="pill-row">
      <span class="pill">portfolio + notes</span>
      <span class="pill">static, low JS</span>
      <span class="pill">hand-styled UI</span>
    </div>
  </section>

  <div class="content-grid">
    <div class="stacked-panels">
      <section class="panel">
        <div class="section-header">
          <h2>Projects</h2>
          <a href="/projects">VIEW ALL</a>
        </div>
        <div class="grid">
          {projects.map((project) => (
            <EntryCard
              title={project.data.title}
              href={`/projects#${project.slug}`}
              eyebrow={`${project.data.year} • ${project.data.status}`}
              summary={project.data.description}
              tags={project.data.tags}
              meta={project.data.role}
            />
          ))}
        </div>
      </section>

      <section class="panel panel--stretch" style="margin-top: 20px;">
        <div class="section-header">
          <h2>Links</h2>
          <a href="/links">VIEW ALL</a>
        </div>
        <div class="grid">
          {links.map((link) => (
            <EntryCard
              title={link.data.title}
              href={link.data.url}
              external
              eyebrow={link.data.category}
              summary={link.data.description}
            />
          ))}
        </div>
      </section>
    </div>

    <section class="panel">
      <div class="section-header">
        <h2>About</h2>
      </div>
      <p class="tagline">
        long time computer guy.
      </p>
      <div class="grid">
        {resumeTiles.map((tile) => (
          <EntryCard
            title={tile.title}
            href={tile.href ?? '/projects'}
            eyebrow={tile.eyebrow}
            summary={tile.summary}
            external={tile.external}
          />
        ))}
      </div>
    </section>
  </div>

</BaseLayout>
